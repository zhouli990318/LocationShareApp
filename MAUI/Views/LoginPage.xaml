<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="LocationShareApp.Views.LoginPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:LocationShareApp.ViewModels"
             x:DataType="viewmodels:LoginViewModel"
             Title="{Binding Title}"
             Shell.NavBarIsVisible="False">

    <ScrollView>
        <Grid RowDefinitions="*,Auto,*" Padding="20">
            
            <!-- Logo区域 -->
            <StackLayout Grid.Row="0" VerticalOptions="End" Spacing="20">
                <Image Source="app_logo.png" 
                       HeightRequest="120" 
                       WidthRequest="120"
                       HorizontalOptions="Center" />
                <Label Text="位置共享" 
                       Style="{StaticResource MaterialHeadline1}"
                       HorizontalOptions="Center"
                       TextColor="{StaticResource Primary}" />
                <Label Text="与家人朋友分享实时位置" 
                       Style="{StaticResource MaterialBody1}"
                       HorizontalOptions="Center"
                       TextColor="{StaticResource OnSurfaceVariant}" />
            </StackLayout>

            <!-- 登录表单 -->
            <StackLayout Grid.Row="1" Spacing="20" Margin="0,40">
                
                <!-- 手机号输入 -->
                <Frame Style="{StaticResource MaterialCard}">
                    <Entry x:Name="PhoneEntry"
                           Text="{Binding PhoneNumber}"
                           Placeholder="请输入手机号"
                           Keyboard="Telephone"
                           Style="{StaticResource MaterialEntry}" />
                </Frame>

                <!-- 密码输入 -->
                <Frame Style="{StaticResource MaterialCard}">
                    <Entry x:Name="PasswordEntry"
                           Text="{Binding Password}"
                           Placeholder="请输入密码"
                           IsPassword="True"
                           Style="{StaticResource MaterialEntry}" />
                </Frame>

                <!-- 错误信息 -->
                <Label Text="{Binding ErrorMessage}"
                       TextColor="Red"
                       FontSize="14"
                       IsVisible="{Binding ErrorMessage, Converter={StaticResource StringToBoolConverter}}"
                       HorizontalOptions="Center" />

                <!-- 登录按钮 -->
                <Button Text="登录"
                        Command="{Binding LoginCommand}"
                        Style="{StaticResource MaterialFAB}"
                        WidthRequest="200"
                        HeightRequest="48"
                        FontSize="16"
                        IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBoolConverter}}" />

                <!-- 加载指示器 -->
                <ActivityIndicator IsVisible="{Binding IsBusy}"
                                   IsRunning="{Binding IsBusy}"
                                   Color="{StaticResource Primary}"
                                   HorizontalOptions="Center" />

            </StackLayout>

            <!-- 注册链接 -->
            <StackLayout Grid.Row="2" VerticalOptions="Start" Margin="0,20">
                <StackLayout Orientation="Horizontal" HorizontalOptions="Center">
                    <Label Text="还没有账号？" 
                           Style="{StaticResource MaterialBody2}"
                           TextColor="{StaticResource OnSurfaceVariant}" />
                    <Label Text="立即注册"
                           Style="{StaticResource MaterialBody2}"
                           TextColor="{StaticResource Primary}"
                           FontAttributes="Bold">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding GoToRegisterCommand}" />
                        </Label.GestureRecognizers>
                    </Label>
                </StackLayout>
            </StackLayout>

        </Grid>
    </ScrollView>

</ContentPage>